<div id="map">
  <script>
    var map;
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        center: {
          lat: 51.243325,
          lng: -0.589844
        },
        zoom: 17
      });

      <% LandMark.all.each do |mark| %>
      var _<%= mark.id %> = new google.maps.Marker({
        map: map,
        position: {
          lat : <%= mark.lat %>,
          lng: <%= mark.long %>
        },
        <% if mark.is_gym %>
          <%= raw "icon\: {url\: \"http://maps.google.com/mapfiles/ms/icons/red-dot.png\"}" %>
        <% else %>
          <%= raw "icon\: {url\: \"http://maps.google.com/mapfiles/ms/icons/blue-dot.png\"}" %>
        <% end %>
      });
      <% end %>

      var marker = new google.maps.Marker({
        map: map,
        position: {
          lat: 51.243325,
          lng: -0.589844
        }
      });

      var infoWindow = new google.maps.InfoWindow({
        content: '<a href=\"<%= new_poke_event_url(land_mark_id: '2') %>\">here</a>'
      });

      marker.addListener('click', function() {
          infoWindow.open(map, marker);
        });


    }
  </script>
</div>

<h1>LetsGo#home</h1>
<p>Find me in app/views/lets_go/home.html.erb</p>

<!-- This is how to make only one infowindow -->
<!-- https://stackoverflow.com/questions/1875596/have-just-one-infowindow-open-in-google-maps-api-v3 -->

<script async="async" defer="defer" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCVqQXR-NMqREuqwTCTA58MmYWAa_LyOEg&callback=initMap"></script>
